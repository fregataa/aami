# Default Alert Templates
# These templates are loaded into the database during installation

templates:
  - id: high_cpu_usage
    name: High CPU Usage
    description: Alert when CPU usage exceeds threshold
    severity: warning
    query_template: |
      100 - (avg by(instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > {{ .threshold }}
    default_config:
      threshold: 80
      for_duration: "5m"

  - id: high_memory_usage
    name: High Memory Usage
    description: Alert when memory usage exceeds threshold
    severity: warning
    query_template: |
      (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > {{ .threshold }}
    default_config:
      threshold: 90
      for_duration: "5m"

  - id: low_disk_space
    name: Low Disk Space
    description: Alert when disk space is running low
    severity: warning
    query_template: |
      (node_filesystem_avail_bytes{fstype!~"tmpfs|fuse.lxcfs|squashfs|devtmpfs"} / node_filesystem_size_bytes) * 100 < {{ .threshold }}
    default_config:
      threshold: 20
      for_duration: "5m"

  - id: node_down
    name: Node Down
    description: Alert when node is unreachable
    severity: critical
    query_template: |
      up{job="node-exporter"} == 0
    default_config:
      for_duration: "2m"

  - id: high_gpu_temperature
    name: High GPU Temperature
    description: Alert when GPU temperature exceeds threshold
    severity: critical
    query_template: |
      dcgm_gpu_temp > {{ .threshold }}
    default_config:
      threshold: 85
      for_duration: "3m"

  - id: high_gpu_memory
    name: High GPU Memory Usage
    description: Alert when GPU memory usage exceeds threshold
    severity: warning
    query_template: |
      (dcgm_fb_used / dcgm_fb_total) * 100 > {{ .threshold }}
    default_config:
      threshold: 90
      for_duration: "5m"

  - id: high_network_traffic
    name: High Network Traffic
    description: Alert when network traffic exceeds threshold
    severity: info
    query_template: |
      rate(node_network_receive_bytes_total[5m]) * 8 / 1000000 > {{ .threshold_mbps }}
    default_config:
      threshold_mbps: 100
      for_duration: "5m"

  - id: high_load_average
    name: High Load Average
    description: Alert when system load average is too high
    severity: warning
    query_template: |
      node_load1 / on(instance) count by (instance) (node_cpu_seconds_total{mode="idle"}) > {{ .threshold }}
    default_config:
      threshold: 2
      for_duration: "10m"
